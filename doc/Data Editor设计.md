# 物编设计思路

## 组成小队

* 队长单位：拥有弹仓技能（arm magazine），弹药类型为小队单位
  * 弹仓技能搭配队列技能（queue）实现充能
* 队员单位：拥有组队技能
  * 组队技能尝试对队列进行修改实现以A单位向B单位添加弹药

## 小队状态

* 通过设置leash参数控制小队单位与队长的最大距离
* 通过修改弹药（小队成员）的create效果，将小队成员的碰撞体积改为0，避免把队长推走而到处乱跑
* 当小队成员不为0时，设置队长单位的碰撞体积为一个更大的值，在平衡DPH的同时，避免无碰撞体积的队员造成聚团混乱的情况

## 一些问题

* 验证器对于compare cargo在magazine部分有神秘的问题，检测的load、free值都不对
* 一个弹仓多个弹药的情况下，给不同弹药补充充能，只能作用于第一个弹药

## Buff套用和移除

* 所有通过小队充能（Charge）给予队长的行为（behavior），分为两个类别
  * 基础属性修改：这类行为的类别使用既定类别中的（user10 equipment-gadget）
  * 个性化buff增益（如采集速率增加等）：使用既定类别中的（user9 equipment-weapon）
* 套用增益部分每个兵种独立使用一个apply behavior进行buff的套用（因为user类别只有1-15个可以由玩家自由使用，为了避免冲突，在套用增益时候写独立的setter）
* 通过验证器验证当前单位类型（是否为采集者，通过是否具有harvest类技能来识别；是否为步兵/载具/飞行器之后再写验证器），当验证器满足时当前buff则可用
* 而在disband技能触发之后，通过一个remove behavior将user 9和user10类别下的buff全部移除，用来确保行为一致性

## 自动采集行为

* 照搬了瓦斯自动采集，发现不能直接套用在矿上
* 原因是自动采集行为会从behavior-resource中扣除资源，并给于这个行为所在阵营的玩家资源量的增加
* 晶体矿默认是中立玩家，所以直接应用这个行为只会扣矿，不会加给自己（player01）
* 需要一个马甲单位作为中介